---
title: "Atividade pr√°tica n. 2"
author: "Grupo 9"
date: "04 de outubro de 2022"
output:
  html_document: default
  pdf_document:
    keep_tex: yes
  word_document: default
editor_options: 
  markdown: 
    wrap: 72
---

**Relat√≥rio do grupo 9**

Tema: *relat√≥rio completo sobre investimento em empresas estatais*

## Quest√£o 0:

Iniciando os modulos, os dados para as analises e as fun√ß√µes necessarias

```{r, message = FALSE}
#install.packages("stargazer")
library(stargazer)
```

## Quest√£o 1:

Baixe o relat√≥rio e declare no R que a coluna Data cont√©m informa√ß√µes
temporais.

```{r}
data <- read.csv("ArquivoExercicio2.csv",sep=";",header=TRUE)

data$Data <- as.Date(data$Data)
```

## Quest√£o 2:

Crie no R gr√°ficos com os retornos dos 3 ativos ao longo do tempo.
Analise os resultados dando destaque ao per√≠odo da pandemia de COVID-19.

Graficos da BBSA3

```{r}
plot(data$Data,data$BBSA3,col="Blue",
     main = "Retorno por dia da BBSA3")
abline(v=18320,col="Red")
```

Graficos da PETR4

```{r}
plot(data$Data,data$PETR4,col="Blue",
     main = "Retorno por dia da PETR4")
abline(v=18320,col="Red")
```

Graficos da CMIG4

```{r}
plot(data$Data,data$CMIG4,col="Blue",
     main = "Retorno por dia da CMIG4")
abline(v=18320,col="Red")
```
  Podemos observar que as tr√™s empresas apresentavam retornos relativamente constantes e n√£o muito dispersos. Particularmente, a Petrobr√°s √© a  que apresenta um retorno mais centrado no 0, enquanto a Cemig e o Banco do Brasil apresentam retornos um pouco mais dispersos, mas tamb√©m perto do 0. Agora, na √©poca da pandemia do Covid-19, podemos observar uma grande dispers√£o dos retornos, formando quase uma linha vertical no gr√°fico, o que indica que os retornos foram mais inconstantes nesse per√≠odo inicial da pandemia. Agora, como as duas empresas s√£o muito consistentes no mercado, pouco tempo depois da pandemia, elas j√° voltaram a ter retornos mais pre-pandemia.

## Quest√£o 3:

Estime o excesso de retornos dos 3 ativos.

```{r}
ativos <- c("BBSA3","PETR4","CMIG4")
estatisticas <- c("Minimo","Media","Maximo","Desvio Padrao")

excessos <- matrix(,nrow=547,ncol=3)
colnames(excessos) <- ativos

for (ativo in ativos){
  excessos[,ativo] <- data[,ativo] - data$RF
}

rownames(excessos) <- data$Data

output <- matrix(,nrow=4,ncol=3)
colnames(output) <- ativos
rownames(output) <- estatisticas

for (ativo in ativos){
  output["Minimo",ativo] <- min(excessos[,ativo])
  output["Media",ativo] <- median(excessos[,ativo])
  output["Maximo",ativo] <- max(excessos[,ativo])
  output["Desvio Padrao",ativo] <- sd(excessos[,ativo])
}
output
```

## Quest√£o 4:

Para cada uma das a√ß√µes, estime o modelo CAPM e analise do ponto de vista
econom√©trico e financeiro os coeficientes A e B estimados
### Ativo BBSA3
```{r}
CAPM_BBSA3 <- lm(BBSA3 ~ MKT,data = data)
```
  De acordo com o modelo, o alfa tem valor num√©rico de -0,0011616. Entretanto, o seu P-valor √© de 10,80%, o que significa que o alfa tem mais que 5% de chance de pertencer a uma normal com m√©dia 0, o que pode fazer com que ele seja insignificante. Por√©m, caso ele tivesse valor significativo, financeiramente ele indicaria o retorno da empresa que n√£o depende da vari√°vel analisada. J√° o ativo beta tem valor num√©rico igual a 1,295843 e um P-valor bem menor do que 5%, o que faz com que o seu valor seja significativo para o modelo. O beta, por sua vez, indica a volatilidade do mercado, e, por ser maior que 1, indica que o ativo √© mais vol√°til que o mercado. Alem do mais, uma varia√ß√£o positiva do mercado indica que o ativo tende a variar positivamente.
### Ativo PETR4
```{r}
CAPM_PETR4 <- lm(PETR4 ~ MKT,data = data)
```
  Analisando esse ativo, o alfa tem valor num√©rico de -0.0008972. Por√©m, o seu P-valor tamb√©m √© bem alto, de 43,3%, o que significa que o alfa tem mais que 5% de chance de pertencer a uma normal com m√©dia 0, o que pode faz com que ele seja insignificante. Agora, caso tivesse valor significativo no modelo, financeiramente ele indicaria o retorno da empresa que n√£o depende da vari√°vel analisada. J√° o ativo beta tem valor num√©rico igual a 1,4451268 e um P-valor bem menor do que 5%, o que faz com que o seu valor seja significativo para o modelo. O beta, por sua vez indica a volatilidade do mercado, e, por ser, mais uma vez maior que 1, indica que o ativo √© mais vol√°til que o mercado. Com uma varia√ß√£o positiva do mercado, o modelo indica que a variavel analisada tende a variar mais.

### Ativo CMIG4 
```{r}
CAPM_CMIG4 <- lm(CMIG4 ~ MKT,data = data)
```
  J√° na Cemig, o alfa tem valor num√©rico de -0,0004622, mas mais uma vez possui um P-valor superior √† 5%, o que faz com que ele seja descartado do modelo. Agora, caso tivesse valor significativo, indicaria o retorno da empresa que n√£o depende da vari√°vel analisada. J√° o ativo beta tem valor num√©rico igual a 1,0755346 e um P-valor inferior √† 5%, o que indica, mais uma vez, que o ativo √© mais vol√°til que o mercado.

## Quest√£o 5:

Insira no gr√°fico de dispers√£o anterior uma linha que representa o
modelo linear na cor azul.

```{r}
#Grafico Anterior:
plot(dados$`PL em milhoes`, dados$Retorno,
     pch  = 8,
     col  = "green",
     lwd  = 5,
     main = "Rela√ß√£o entre Retorno e Patrimonio liquido de fundos de investimento",
     xlab = "Patrimonio Liquido do fundo",
     ylab = "Retorno do fundo")
#Linha Azul:
abline(reg, col=4)
```

## Quest√£o 6:

Mostre o resultado do modelo e a adequabilidade da modelagem.

```{r,echo = FALSE}

coeficientes <- coef(reg)
paste("Coeficiente do intercepto:",coeficientes[1])
paste("Coeficiente do X:",coeficientes[2])
```

O resultado do modelo s√£o os coeficientes citados a cima

```{r}
reg_slm <- summary(reg)
paste("P valor do intercepto=",reg_slm$coefficients[1,4])
paste("P valor do Coeficiente=",reg_slm$coefficients[2,4])
```

A adequabilidade n√£o √© das melhores, o P valor do intercepto √© alto,
fazendo assim ter grandes chances de fazer parte de um resultado nulo,
j√° o do coeficiente tem sua importancia

## Quest√£o 7

Analise o poder explicativo do modelo.

```{r, echo = FALSE}
paste("R2 do modelo =",reg_slm$r.squared)
```

O poder explicativo do modelo √© 53,5% o R¬≤, ou seja, 53,5% dos
resultados dos fundos podem ser explicados pelo fator PL, uma chance
consideravel para um modelo de apenas uma variavel

## Quest√£o 8

Analise o significado do valor e signific√¢ncia de ùõº e ùõΩ gerados a um
n√≠vel de signific√¢ncia de 5%

```{r}

paste("P valor do intercepto=",reg_slm$coefficients[1,4])
paste("P valor do Coeficiente=",reg_slm$coefficients[2,4])
```

O p valor do intercepto √© maior que 5% por isso faz a variavel ser pouco
efetiva ao modelo tendo alta chance de fazer parte de uma hipotese
nula,j√° o p valor do coeficiente √© menor que 5%, por isso √© significante

## Quest√£o 9

Crie uma expectativa de Ret para um fundo com PL igual a R\$7.800,00.

```{r}
result <- reg_slm$coefficients[1,1] + reg_slm$coefficients[2,1] * 7800
paste("Retorno esperado= ",round(result * 100,3),"%",sep="")
```

## Quest√£o 10

Fa√ßa uma nova estima√ß√£o considerando agora um modelo sem intercepto (ùõº =
0).

```{r}
x <- dados$`PL em milhoes`
y <- dados$Retorno
regSemAlfa <- lm(y ~ x - 1)
```

## Quest√£o 11

Insira no gr√°fico de dispers√£o a reta deste novo modelo na cor vermelha.

```{r}
#Grafico Anterior:
plot(dados$`PL em milhoes`, dados$Retorno,
     pch  = 8,
     col  = "green",
     lwd  = 5,
     main = "Rela√ß√£o entre Retorno e Patrimonio liquido de fundos de investimento",
     xlab = "Patrimonio Liquido do fundo",
     ylab = "Retorno do fundo")
#Linha Azul:
abline(reg, col=4)

#Linha vermelha nova:
abline(regSemAlfa, col="red")
```

## Quest√£o 12

Analise a validade do modelo, poder explicativo do modelo e a magnitude
e signific√¢ncia do B

```{r}
regSemAlfa_slm <- summary(regSemAlfa)
paste("R2 do novo modelo=",regSemAlfa_slm$r.squared)
paste("P valor do novo modelo=",glance(regSemAlfa)$p.value)
paste("P valor do novo X=",regSemAlfa_slm$coefficients[,4])
```

O poder explicativo (R2) foi para 85% sendo um modelo mais adequado que
o primeiro. O P Valor de x dele se tornou estatisticamente igual a 0 e o
P Valor do modelo se tornou estatisticamente igual 0

## Quest√£o 13

Compare os resultados dos dois modelos e justifique em termos
estat√≠sticos qual dos dois modelos √© mais adequado.

```{r}
paste("R2 do novo modelo=",regSemAlfa_slm$r.squared)
paste("P valor do novo modelo=",glance(regSemAlfa)$p.value)
paste("R2 do antigo modelo=",reg_slm$r.squared)
paste("P valor do Antigo modelo=",glance(reg)$p.value)
paste("Melhoria do R2 = ", (regSemAlfa_slm$r.squared - reg_slm$r.squared)/ reg_slm$r.squared *100, "%", sep="")
```

O modelo novo √© o mais adequado, estatisticamente falando. O R2, poder
explicativo, dele foi maior e o novo P valor do novo √© t√£o
insignificante que na computa√ß√£o se tornou NA, ou seja, √© um modelo mais
adequado

## Quest√£o 14

Responda a seu cliente qual a melhor op√ß√£o de fundo para investir, os
menores ou os maiores

Mesmo com a regress√£o mais fraca, j√° demonstrava uma tendencia de fundos
com patrimonios maiores terem mais retorno. Com a regress√£o mais
adequada a tendencia foi confirmada, segundo o coeficiente de X:

```{r}
paste("Coeficiente de x", regSemAlfa_slm$coefficients[1])
```

a cada varia√ß√£o de 1 milh√£o de PL do fundo, o rendimento tende a esse
coeficiente maior, alem do mais a rela√ß√£o √© positiva, ou seja, um
aumenta, o outro tambem.

## Quest√£o 15:

Por fim, levante hip√≥teses sobre outros fatores que podem impactar o ret
de fundos de investimentos.

Levando em considera√ß√£o o artigo: [IMPACTO DA RELA√á√ÉO ENTRE TAXAS DE
ADMINISTRA√á√ÉO E O TAMANHO DO FUNDO NA PERFORMANCE FUTURA DOS FUNDOS DE
INVESTIMENTO](https://convibra.org/congresso/res/uploads/pdf/artigo23093_20201802.pdf)
O *Patrimonio Liquido logaritimizado* apresenta uma *rela√ß√£o negativa*,
juntamente com a *Taxa de administra√ß√£o* e a *Idade do fundo*, j√° por
outro lado, apresentam uma *rela√ß√£o positiva* as variaveis *Taxa de
performance* a *Taxa de administra√ß√£o ao quadrado*
